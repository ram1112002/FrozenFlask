<!DOCTYPE html>
<html>
<head>
  <title>Biodata</title>
</head>
<body>
  <h1>BIODATA</h1>
  <form id="myForm">
    <h3>Personal Details</h3>
    <br>
    <label for="user_input">Name:</label>
    <input type="text" id="user_input" required><br>
    <br>
    <label for="user_dob">Date of Birth:</label>
    <input type="text" id="user_dob" required><br>
    <br>
    <label for="user_time">Time of Birth:</label>
    <input type="text" id="user_time" required><br>
    <br>
    <label for="user_place">Place of Birth:</label>
    <input type="text" id="user_place" required><br>
    <br>
    <label for="user_rashi">Rashi:</label>
    <input type="text" id="user_rashi" required><br>
    <br>
    <label for="user_nakshatra">Nakshatra:</label>
    <input type="text" id="user_nakshatra" required><br>
    <br>
    <label for="user_height">Height:</label>
    <input type="text" id="user_height" required><br>
    <br>
    <label for="user_religion">Religion:</label>
    <input type="text" id="user_religion" required><br>
    <br>
    <label for="user_caste">Caste:</label>
    <input type="text" id="user_caste" required><br>
    <br>
    <label for="user_subcaste">Sub caste:</label>
    <input type="text" id="user_subcaste" required><br>
    <br>
    <label for="user_gotra">Gotra:</label>
    <input type="text" id="user_gotra" required><br>
    <br>
    <label for="user_manglik">Manglik:</label>
    <input type="text" id="user_manglik" required><br>
    <br>
    <label for="user_edu">Education:</label>
    <input type="text" id="user_edu" required><br>
    <br>
    <label for="user_college">College Name:</label>
    <input type="text" id="user_college" required><br>
    <br>
    <label for="user_employ">Employed in:</label>
    <input type="text" id="user_employ" required><br>
    <br>
    <label for="user_orgname">Organization Name:</label>
    <input type="text" id="user_orgname" required><br>
    <br>
    <label for="user_income">Annual Income:</label>
    <input type="text" id="user_income" required><br>
    <br>
    <h3>Family Details</h3>
    <br>
    <label for="user_fn">Father's Name:</label>
    <input type="text" id="user_fn" required><br>
    <br>
    <label for="user_fo">Father's Occupation:</label>
    <input type="text" id="user_fo" required><br>
    <br>
    <label for="user_mn">Mother's Name:</label>
    <input type="text" id="user_mn" required><br>
    <br>
    <label for="user_mo">Mother's Occupation:</label>
    <input type="text" id="user_mo" required><br>
    <br>
    <label for="user_tbrother">Total Brothers:</label>
    <input type="text" id="user_tbrother" required><br>
    <br>
    <label for="user_tsister">Total Sisters:</label>
    <input type="text" id="user_tsister" required><br>
    <br>
    <label for="user_mbrother">Married Brothers:</label>
    <input type="text" id="user_mbrother" required><br>
    <br>
    <label for="user_msister">Married Sisters:</label>
    <input type="text" id="user_msister" required><br>
    <br>
    <h3>Contact Details</h3>
    <br>
    <label for="user_number">Contact Number:</label>
    <input type="text" id="user_number" required><br>
    <br>
    <label for="user_address">Address:</label>
    <input type="text" id="user_address" required><br>
    <br>



    <button type="submit">Submit</button>
  </form>

  <script>
    let valid = true;
    const form = document.getElementById('myForm');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById("user_input").value.toLowerCase();
      const validCharacters = /^[a-zA-Z0-9_.]+$/;
      if (!validCharacters.test(name)) {
        alert('Please enter a valid name containing only numbers, characters, underscores, and periods.');
        user_input.focus();
        valid = false;
        return;
      }
      const dob = document.getElementById("user_dob").value;
      const timeOfBirth = document.getElementById("user_time").value;
      const placeOfBirth = document.getElementById("user_place").value;
      const rashi = document.getElementById("user_rashi").value;
      const nakshatra = document.getElementById("user_nakshatra").value;
      const height = document.getElementById("user_height").value;
      const religion = document.getElementById("user_religion").value;
      const caste = document.getElementById("user_caste").value;
      const subcaste = document.getElementById("user_subcaste").value;
      const gotra = document.getElementById("user_gotra").value;
      const manglik = document.getElementById("user_manglik").value;
      const education = document.getElementById("user_edu").value;
      const collegeName = document.getElementById("user_college").value;
      const employedIn = document.getElementById("user_employ").value;
      const organizationName = document.getElementById("user_orgname").value;
      const annualIncome = document.getElementById("user_income").value;
      const fatherName = document.getElementById("user_fn").value;
      const fatherOccupation = document.getElementById("user_fo").value;
      const motherName = document.getElementById("user_mn").value;
      const motherOccupation = document.getElementById("user_mo").value;
      const totalBrothers = document.getElementById("user_tbrother").value;
      const totalSisters = document.getElementById("user_tsister").value;
      const marriedBrothers = document.getElementById("user_mbrother").value;
      const marriedSisters = document.getElementById("user_msister").value;
      const contactNumber = document.getElementById("user_number").value;
      const address = document.getElementById("user_address").value;

      const data = {
        name: name,
        date_of_birth: dob,
        time_of_birth: timeOfBirth,
        place_of_birth: placeOfBirth,
        rashi: rashi,
        nakshatra: nakshatra,
        height: height,
        religion: religion,
        caste: caste,
        subcaste: subcaste,
        gotra: gotra,
        manglik: manglik,
        education: education,
        college_name: collegeName,
        employed_in: employedIn,
        organization_name: organizationName,
        annual_income: annualIncome,
        father_name: fatherName,
        father_occupation: fatherOccupation,
        mother_name: motherName,
        mother_occupation: motherOccupation,
        total_brothers: totalBrothers,
        total_sisters: totalSisters,
        married_brothers: marriedBrothers,
        married_sisters: marriedSisters,
        contact_number: contactNumber,
        address: address
      };
      if(valid == true){

        const url = 'https://biodata.fastgen.com/create-user';

        const response = await fetch(url, {
          method: 'POST',
          headers: {

          },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          console.log('Data sent successfully');
          window.location.href = '/S.html';
        }else if(response.status == 410){
          console.error("Duplicate Data",response.status);
          alert("This user name is already there");
        }
        else {
          console.error('Error occurred:', response.status);
        }
    
      }
      
  
    })
  </script>
</body>
</html>